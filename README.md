# La Despensa - Sistema de Gesti√≥n para Almacenes

![Logo de La Despensa](/frontend/public/LaDespensaLogo.png)

## Descripci√≥n

La Despensa es un sistema completo de gesti√≥n para almacenes y tiendas minoristas que permite administrar inventario, ventas, proveedores, finanzas, cuentas por pagar y gesti√≥n de deudores. Dise√±ado espec√≠ficamente para satisfacer las necesidades de peque√±os y medianos negocios del sector retail con caracter√≠sticas avanzadas de an√°lisis financiero y notificaciones en tiempo real.

## Funcionalidades Principales

### üè† Dashboard Principal
- **Panel de control unificado** con m√©tricas principales del negocio
- **Estad√≠sticas en tiempo real** de ventas, productos y deudores
- **Gr√°ficos interactivos** con navegaci√≥n entre diferentes per√≠odos
- **Resumen de deudores** con vista r√°pida de estado de pagos
- **Generaci√≥n de reportes** completos con descarga en PDF
- **Indicadores visuales** de rendimiento y tendencias

### üì¶ Gesti√≥n Avanzada de Productos
- **Registro completo** con datos detallados (nombre, c√≥digo de barras, categor√≠a, precio, stock, imagen)
- **Historial de precios** que permite seguimiento de cambios a lo largo del tiempo
- **Gesti√≥n de im√°genes** para cada producto con soporte para carga y almacenamiento
- **Sistema de categorizaci√≥n** flexible con 15+ categor√≠as predefinidas
- **B√∫squeda avanzada** por nombre, c√≥digo de barras, categor√≠a o disponibilidad
- **Filtros inteligentes** por stock, categor√≠a, fecha de vencimiento y m√°s
- **Alertas autom√°ticas** para productos con bajo stock seg√∫n niveles predefinidos por categor√≠a
- **Monitoreo de fechas de vencimiento** con notificaciones para productos pr√≥ximos a vencer
- **Listado de productos vencidos** para facilitar su identificaci√≥n y retirada
- **Modal de informaci√≥n detallada** con estad√≠sticas de ventas, margen de ganancia y valor de inventario
- **Edici√≥n en l√≠nea** con modal optimizado y vista previa de cambios
- **C√°lculo autom√°tico de precios recomendados** basado en m√°rgenes por categor√≠a
- **Exportaci√≥n a PDF** con filtros aplicados y datos completos
- **Sistema de skeleton loading** para mejor experiencia de usuario

### üõí Terminal de Ventas (TPV) Avanzado
- **Interface intuitiva** optimizada para velocidad de uso
- **Escaneo por c√≥digo de barras** para identificaci√≥n r√°pida de productos
- **B√∫squeda inteligente** por nombre o c√≥digo con sugerencias autom√°ticas
- **Carrito de compras** din√°mico con gesti√≥n de cantidades en tiempo real
- **M√∫ltiples m√©todos de pago** (efectivo, tarjeta de cr√©dito/d√©bito)
- **Gesti√≥n de clientes deudores** integrada con creaci√≥n r√°pida
- **C√°lculo autom√°tico** de totales, impuestos y cambio
- **Generaci√≥n autom√°tica de tickets** con numeraci√≥n secuencial (formato TK-XXXXXX)
- **Descuento autom√°tico de inventario** tras cada venta
- **Validaciones en tiempo real** de stock y disponibilidad
- **Alertas inteligentes** para productos vencidos o con stock bajo durante la venta
- **Soporte para ventas a cr√©dito** con registro autom√°tico en deudores

### üìä Historial de Ventas Completo
- **Visualizaci√≥n cronol√≥gica** con ordenamiento por fecha y hora
- **B√∫squeda avanzada** por fecha, producto, m√©todo de pago o n√∫mero de ticket
- **Filtrado por categor√≠as** de productos para an√°lisis detallado
- **Sistema de devoluciones** parciales o completas con actualizaci√≥n autom√°tica de inventario
- **C√°lculo autom√°tico** del importe a devolver en devoluciones parciales
- **Anulaci√≥n de ventas** completas con restauraci√≥n de stock
- **Exportaci√≥n a PDF y Excel** de reportes de ventas con filtros aplicados
- **Vista detallada** de cada ticket con productos vendidos
- **Paginaci√≥n inteligente** para manejo eficiente de grandes vol√∫menes
- **Estad√≠sticas autom√°ticas** de productos m√°s vendidos por per√≠odo

### üí∞ Gesti√≥n Integral de Deudores
- **Registro completo** de clientes con deudas pendientes (nombre, tel√©fono, direcci√≥n, monto)
- **Seguimiento detallado** de pagos parciales con actualizaci√≥n autom√°tica del saldo
- **Historial cronol√≥gico** completo de todas las transacciones por cliente
- **Sistema de recordatorios** basado en fechas comprometidas de pago
- **Categorizaci√≥n autom√°tica** de deudas por antig√ºedad y monto
- **Panel de control** con visualizaci√≥n general e individual de deudores
- **Filtros avanzados** por nombre, monto, estado de pago y antig√ºedad de deuda
- **Indicadores visuales** para deudas pr√≥ximas a vencer, vencidas o al d√≠a
- **Sistema de comentarios** expandibles para cada transacci√≥n en el historial
- **M√©todos de pago m√∫ltiples** (efectivo, tarjeta) para registro de cobros
- **Estad√≠sticas autom√°ticas** del mayor deudor, deuda promedio y totales
- **Interfaz intuitiva** para visualizar pagos y deudas con distinci√≥n visual clara
- **Exportaci√≥n a PDF** con datos completos y filtros aplicados
- **Modales optimizados** para edici√≥n, historial y registro de pagos

### üè¢ Gesti√≥n Completa de Proveedores
- **Cat√°logo detallado** de proveedores con informaci√≥n completa de contacto
- **Vinculaci√≥n inteligente** entre productos y proveedores que los suministran
- **Visualizaci√≥n de productos** asociados a cada proveedor con im√°genes
- **Gesti√≥n din√°mica** para agregar o quitar productos vinculados
- **B√∫squeda de productos** por proveedor para facilitar pedidos y gesti√≥n
- **Panel de control** con visualizaci√≥n de todos los proveedores activos/inactivos
- **Sistema de estados** (activo/inactivo) para gesti√≥n de proveedores
- **Edici√≥n completa** de informaci√≥n de contacto y datos comerciales
- **Categorizaci√≥n autom√°tica** basada en productos suministrados
- **Filtros avanzados** por nombre, categor√≠a, estado y productos
- **Exportaci√≥n a PDF** con listado completo de proveedores
- **Paginaci√≥n inteligente** para manejo eficiente de grandes cat√°logos
- **Modal de vinculaci√≥n** de productos con b√∫squeda y selecci√≥n m√∫ltiple

### üìà Dashboard Financiero Avanzado
- **Panel de indicadores clave** con m√©tricas principales del negocio en tiempo real
- **Gr√°ficos interactivos** para visualizaci√≥n de ventas, stock y finanzas
- **An√°lisis por per√≠odos** (semana, mes, a√±o, personalizado) con comparativas
- **Indicadores de rentabilidad** por producto y categor√≠a con c√≥digo de colores
- **C√°lculo autom√°tico** de ganancias basado en costo vs. precio de venta
- **Seguimiento de gastos** categorizados por tipo y per√≠odo
- **Balance completo** de ingresos y egresos con visualizaci√≥n clara
- **Tarjetas de resumen** con m√©tricas de ingresos, costos y transacciones
- **Filtros temporales** avanzados con selecci√≥n espec√≠fica de fechas
- **Tooltips informativos** que explican cada m√©trica y su interpretaci√≥n
- **Secciones especializadas**:
  - **General**: Resumen financiero y m√©tricas principales
  - **Ingresos**: An√°lisis detallado de ventas por d√≠a, categor√≠a y tendencias
  - **Productos**: Productos m√°s vendidos, categor√≠as por volumen y an√°lisis de inventario
  - **Rentabilidad**: Margen de ganancia por categor√≠a y an√°lisis de rendimiento
- **Vista de tabla/gr√°fico** intercambiable para cada secci√≥n
- **An√°lisis de inversi√≥n** por categor√≠a con porcentajes y valores
- **Comparativa financiera** visual entre ingresos, costos y ganancias
- **Exportaci√≥n completa a PDF** con reportes profesionales detallados

### üí≥ Cuentas por Pagar
- **Creaci√≥n detallada** de cuentas por pagar (nombre, identificador, monto, categor√≠a)
- **Organizaci√≥n anual** con visualizaci√≥n en formato de tabla por meses
- **Categorizaci√≥n personalizable** (Luz, Agua, Gas, Internet, Alquiler, Impuestos, etc.)
- **Control de estados** (Pendiente, Pagado) con actualizaci√≥n inmediata
- **Marcado r√°pido** de cuentas como pagadas con un solo clic
- **Posibilidad de desmarcar** cuentas pagadas si es necesario
- **Visualizaci√≥n mensual** para mejor organizaci√≥n y planificaci√≥n
- **Edici√≥n completa** de cualquier aspecto de las cuentas registradas
- **Filtros avanzados** por nombre, categor√≠a, estado y a√±o
- **B√∫squeda r√°pida** por nombre o identificador fiscal
- **Resumen autom√°tico** por mes con totales y estad√≠sticas
- **Exportaci√≥n a PDF** con generaci√≥n autom√°tica de reportes detallados
- **Paginaci√≥n inteligente** para manejo eficiente de grandes vol√∫menes

### üîî Sistema de Notificaciones en Tiempo Real
- **Centro de notificaciones** integrado en la barra de navegaci√≥n
- **WebSocket en tiempo real** para alertas instant√°neas
- **Tipos de alertas**:
  - Stock bajo (productos por debajo del m√≠nimo por categor√≠a)
  - Productos vencidos (con fecha de vencimiento expirada)
  - Productos por vencer (pr√≥ximos a la fecha de vencimiento)
  - Recordatorios de pagos de deudores
  - Alertas de cuentas por pagar
- **Notificaciones con sonido** para alertas cr√≠ticas
- **Persistencia local** de notificaciones no le√≠das
- **Gesti√≥n completa** con marcar como le√≠da y limpiar historial
- **Iconograf√≠a espec√≠fica** para cada tipo de alerta
- **Contador visual** de notificaciones no le√≠das
- **Integraci√≥n con email** para alertas importantes

### üìÑ Sistema de Reportes y Exportaci√≥n
- **Servicio centralizado** de exportaci√≥n con m√∫ltiples formatos
- **Reportes en PDF** con dise√±o profesional y branding
- **Exportaci√≥n a Excel** para an√°lisis externos
- **Tipos de reportes**:
  - **Reporte de cierre de caja** diario autom√°tico
  - **Reporte financiero** con an√°lisis completo por per√≠odos
  - **Reporte de productos** con filtros aplicados
  - **Reporte de proveedores** con datos completos
  - **Reporte de deudores** con estados de cuenta
  - **Reporte de historial de ventas** con an√°lisis detallado
- **Generaci√≥n autom√°tica** al cerrar sesi√≥n
- **Personalizaci√≥n** de per√≠odos y filtros en cada reporte
- **Tablas formateadas** con autoTable para mejor presentaci√≥n
- **Metadatos completos** (fecha, usuario, per√≠odo, filtros aplicados)

### üé® Experiencia de Usuario Optimizada
- **Componentes Skeleton** para mejor percepci√≥n de carga
- **Modales optimizados** con gesti√≥n de scroll y accesibilidad
- **Animaciones suaves** y transiciones optimizadas
- **Responsive design** adaptado a diferentes dispositivos
- **Sistema de temas** consistente con variables CSS
- **Iconograf√≠a consistente** con FontAwesome
- **Feedback visual** inmediato para todas las acciones
- **Validaciones en tiempo real** con mensajes claros
- **Estados de carga** visibles en todas las operaciones as√≠ncronas
- **Navegaci√≥n intuitiva** con breadcrumbs y men√∫s contextuales

### üîß Caracter√≠sticas T√©cnicas Avanzadas
- **Context API optimizado** para gesti√≥n global de ventas
- **Hooks personalizados** para operaciones comunes
- **Memoizaci√≥n inteligente** para optimizaci√≥n de rendimiento
- **Lazy loading** de componentes pesados
- **Gesti√≥n de estado** eficiente con React hooks
- **Validaci√≥n de datos** en frontend y backend
- **Manejo de errores** robusto con recuperaci√≥n autom√°tica
- **Autenticaci√≥n JWT** con tokens de acceso y refresco
- **Middleware de autorizaci√≥n** por roles
- **WebSocket integration** para tiempo real
- **Optimizaci√≥n de im√°genes** autom√°tica
- **Cache inteligente** para datos frecuentemente accedidos

## Tecnolog√≠as Utilizadas

### Frontend
- **React 18**: Biblioteca principal con hooks y context API
- **React Router v6**: Navegaci√≥n entre componentes con lazy loading
- **Vite**: Herramienta de construcci√≥n ultrarr√°pida y servidor de desarrollo
- **Axios**: Cliente HTTP optimizado para comunicaci√≥n con el backend
- **FontAwesome**: Iconograf√≠a completa para interfaces intuitivas
- **SweetAlert2**: Notificaciones interactivas y di√°logos de confirmaci√≥n optimizados
- **Socket.io-client**: Cliente WebSocket para notificaciones en tiempo real
- **jsPDF & AutoTable**: Generaci√≥n de reportes en PDF con tablas formateadas
- **XLSX**: Exportaci√≥n de datos a formato Excel
- **date-fns**: Manejo optimizado de fechas y locales
- **CSS personalizado**: Estilos espec√≠ficos con variables CSS y responsive design

### Backend
- **Node.js**: Entorno de ejecuci√≥n con optimizaciones de rendimiento
- **Express**: Framework para API RESTful con middleware personalizado
- **MongoDB**: Base de datos NoSQL con agregaciones optimizadas
- **Mongoose**: ODM para modelado de datos con validaciones avanzadas
- **Socket.io**: WebSocket server para notificaciones en tiempo real
- **JWT**: Autenticaci√≥n basada en tokens con refresh tokens
- **Multer**: Gesti√≥n de carga de archivos e im√°genes optimizada
- **Nodemailer**: Servicio de emails para alertas importantes
- **Express-validator**: Validaci√≥n de datos robusta en el backend
- **Dotenv**: Gesti√≥n segura de variables de entorno

## Arquitectura del Sistema

El proyecto implementa una arquitectura moderna cliente-servidor con las siguientes caracter√≠sticas:

### Frontend (SPA - Single Page Application)
- **Aplicaci√≥n React** con componentes modulares y reutilizables
- **Estado global** gestionado con Context API y hooks personalizados
- **Routing** din√°mico con React Router y code splitting
- **PWA ready** con service workers para cache offline
- **WebSocket client** para notificaciones en tiempo real

### Backend (API RESTful + WebSocket)
- **API RESTful** desarrollada con Node.js y Express
- **WebSocket server** para comunicaci√≥n bidireccional en tiempo real
- **Middleware stack** personalizado para autenticaci√≥n, autorizaci√≥n y validaci√≥n
- **Servicios especializados** para emails, alertas y exportaci√≥n
- **Gesti√≥n de archivos** optimizada con Multer

### Base de Datos
- **MongoDB** con esquemas optimizados para consultas frecuentes
- **√çndices compuestos** para b√∫squedas r√°pidas
- **Agregaciones** para an√°lisis financieros complejos
- **Validaciones a nivel de esquema** con Mongoose

### Comunicaci√≥n en Tiempo Real
- **WebSocket connection** para alertas instant√°neas
- **Event-driven architecture** para notificaciones
- **Fallback polling** para conexiones inestables

## Requisitos del Sistema

### Desarrollo
- Node.js (v16.x o superior)
- MongoDB (v5.x o superior)
- NPM (v8.x o superior)

### Producci√≥n
- Node.js (v16.x o superior)
- MongoDB Atlas o MongoDB (v5.x o superior)
- Espacio en disco: M√≠nimo 1GB (sin contar la base de datos)
- Memoria RAM: M√≠nimo 4GB recomendado
- Procesador: Dual-core m√≠nimo

## Instalaci√≥n y Despliegue

### Paso 1: Configuraci√≥n del Backend

1. Clonar el repositorio:
```bash
git clone https://github.com/usuario/LaDespensaTesis.git
cd LaDespensaTesis
```

2. Instalar dependencias del backend:
```bash
cd backend
npm install
```

3. Configurar variables de entorno:
   - Crear un archivo `.env` en la carpeta `backend` con las siguientes variables:
   ```
   HOST=localhost
   PORT=4000
   DB_URL=mongodb://localhost:27017/ladespensa
   ACCESS_JWT_SECRET=tu_secret_key_para_access_token
   REFRESH_JWT_SECRET=tu_secret_key_para_refresh_token
   EMAIL_USER=tu_email@gmail.com
   EMAIL_APP_PASSWORD=tu_contrase√±a_de_aplicacion
   ```

4. Iniciar el servidor de desarrollo:
```bash
npm run dev
```

### Paso 2: Configuraci√≥n del Frontend

1. Instalar dependencias del frontend:
```bash
cd ../frontend
npm install
```

2. Iniciar la aplicaci√≥n de React:
```bash
npm run dev
```

3. Acceder a la aplicaci√≥n en su navegador:
```
http://localhost:5173
```

## Estructura del Proyecto

```
LaDespensaTesis/
‚îú‚îÄ‚îÄ backend/                 # C√≥digo del servidor
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config/          # Configuraci√≥n de la base de datos y variables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/     # Controladores de la API REST
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/     # Middlewares de autenticaci√≥n y autorizaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/          # Modelos de datos (Mongoose)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/          # Rutas de la API REST
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schema/          # Esquemas de validaci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/        # Servicios de negocio (emails, alertas, exportaci√≥n)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/           # Utilidades generales
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îî‚îÄ‚îÄ frontend/                # C√≥digo del cliente
    ‚îú‚îÄ‚îÄ public/              # Archivos est√°ticos
    ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ assets/          # Recursos (im√°genes, etc.)
    ‚îÇ   ‚îú‚îÄ‚îÄ components/      # Componentes reutilizables
    ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Skeleton/    # Componentes de carga optimizados
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Footer/      # Componentes de layout
    ‚îÇ   ‚îú‚îÄ‚îÄ context/         # Contextos de React para estado global
    ‚îÇ   ‚îú‚îÄ‚îÄ helpers/         # Funciones auxiliares (SweetAlert, etc.)
    ‚îÇ   ‚îú‚îÄ‚îÄ hooks/           # Hooks personalizados
    ‚îÇ   ‚îú‚îÄ‚îÄ routes/          # Configuraci√≥n de rutas
    ‚îÇ   ‚îú‚îÄ‚îÄ services/        # Servicios para comunicaci√≥n con API
    ‚îÇ   ‚îú‚îÄ‚îÄ styles/          # Archivos CSS organizados por componente
    ‚îÇ   ‚îî‚îÄ‚îÄ Views/           # Componentes principales/p√°ginas
    ‚îî‚îÄ‚îÄ package.json
```

## Seguridad Implementada

El sistema implementa m√∫ltiples capas de seguridad:

- **Autenticaci√≥n JWT** con tokens de acceso y refresco
- **Autorizaci√≥n basada en roles** con middleware personalizado
- **Validaci√≥n de datos** robusta en cliente y servidor
- **Sanitizaci√≥n de inputs** para prevenir inyecciones
- **Protecci√≥n CORS** configurada espec√≠ficamente
- **Rate limiting** para prevenir ataques de fuerza bruta
- **Encriptaci√≥n de contrase√±as** con bcrypt
- **Gesti√≥n segura** de variables de entorno
- **Validaci√≥n de archivos** subidos al servidor
- **Escape de datos** para prevenir XSS

## Rendimiento y Optimizaci√≥n

- **Lazy loading** de componentes pesados
- **Memoizaci√≥n** de componentes con React.memo
- **Context API optimizado** con providers espec√≠ficos
- **Skeleton components** para mejor UX durante cargas
- **Compresi√≥n de im√°genes** autom√°tica en subida
- **Cache inteligente** para datos frecuentemente accedidos
- **Optimizaci√≥n de queries** de MongoDB con √≠ndices
- **Code splitting** autom√°tico con Vite
- **Bundle optimization** para reducir tama√±o de archivos

---

**Desarrollado por:** @J04K0 y @PabloCastilloFer ¬© 2025

**Tecnolog√≠as principales:** React 18, Node.js, Express, MongoDB, Socket.io, JWT

**Licencia:** MIT - Consulta el archivo LICENSE para m√°s detalles
